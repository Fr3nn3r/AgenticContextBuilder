doc_type: nsa_guarantee
version: v1
description: NSA Guarantee vehicle warranty insurance policy

# Language detection hints
language_hints:
  de:
    - "Spezifische Bedingungen"
    - "Policen Nr"
    - "Angaben zur Garantie"
  en:
    - "Special terms"
    - "Policy Number"
    - "Guarantee Details"

required_fields:
  - policy_number
  - guarantee_type
  - start_date
  - end_date
  - policyholder_name
  - vehicle_make
  - vehicle_model
  - vehicle_vin

optional_fields:
  - guarantee_name
  - waiting_period_days
  - turbo_covered
  - hybrid_covered
  - four_wd_covered
  - tuning_covered
  - commercial_covered
  - assistance_covered
  - max_coverage
  - max_coverage_engine
  - excess_percent
  - excess_minimum
  - policyholder_address
  - policyholder_postal_code
  - policyholder_city
  - policyholder_phone
  - client_reference
  - is_transferable
  - vehicle_fuel_type
  - vehicle_license_plate
  - vehicle_first_registration
  - vehicle_current_km
  - vehicle_displacement_cc
  - vehicle_weight_category_kg
  - vehicle_replacement_value
  - assistance_repatriation_scope
  - assistance_rental_per_day
  - assistance_rental_max_event
  - assistance_towing_amount
  - covered_components
  - excluded_components
  - coverage_scale

field_rules:
  # Policy identification
  policy_number:
    normalize: uppercase_trim
    validate: non_empty
    hints:
      - "Policy Number"
      - "Policen Nr"
      - "Policy Nb"
      - "Guarantee Number"
      - "Garantie Nr"

  guarantee_name:
    normalize: trim
    hints:
      - "Guarantee name"
      - "Garantiename"
      - "Name der Garantie"

  guarantee_type:
    normalize: trim
    hints:
      - "Guarantee type"
      - "Garantietyp"
      - "Type of guarantee"

  start_date:
    normalize: swiss_date_to_iso
    validate: is_date
    hints:
      - "Guarantee start"
      - "Beginn der Garantie"
      - "start date"
      - "Gültig von"
      - "Valid from"

  end_date:
    normalize: swiss_date_to_iso
    validate: is_date
    hints:
      - "Guarantee end"
      - "Ende der Garantie"
      - "end date"
      - "Gültig bis"
      - "Valid until"

  waiting_period_days:
    normalize: extract_number
    hints:
      - "Waiting period"
      - "Karenzzeit"
      - "Grace period"

  # Coverage options (boolean)
  turbo_covered:
    normalize: covered_boolean
    hints:
      - "Turbo"
      - "supercharger"
      - "Kompressor"

  hybrid_covered:
    normalize: covered_boolean
    hints:
      - "Hybrid"
      - "Option Hybrid"

  four_wd_covered:
    normalize: covered_boolean
    hints:
      - "4x4"
      - "4x4-Fahrzeug"
      - "AWD"
      - "all-wheel"

  tuning_covered:
    normalize: covered_boolean
    hints:
      - "Tuning"
      - "Modified"

  commercial_covered:
    normalize: covered_boolean
    hints:
      - "Commercial"
      - "Gewerbliche Nutzung"
      - "Business use"

  assistance_covered:
    normalize: covered_boolean
    hints:
      - "Assistance"
      - "Assistance Paket"
      - "Mobility"

  # Financial
  max_coverage:
    normalize: swiss_currency
    hints:
      - "Maximum cover"
      - "Maximale Deckung"
      - "Max coverage"
      - "Deckungssumme"

  max_coverage_engine:
    normalize: swiss_currency
    hints:
      - "Maximum for engine"
      - "Max Deckung bei Motorschaden"
      - "Engine maximum"

  excess_percent:
    normalize: extract_percentage
    hints:
      - "Excess"
      - "Selbstbehalt"
      - "Deductible"
      - "Franchise"

  excess_minimum:
    normalize: swiss_currency
    hints:
      - "Minimum excess"
      - "Selbstbehalt Minimum"
      - "Minimum deductible"

  # Policyholder
  policyholder_name:
    normalize: trim
    validate: non_empty
    hints:
      - "Name / Company"
      - "Name/Firma"
      - "Policyholder"
      - "Versicherungsnehmer"

  policyholder_address:
    normalize: trim
    hints:
      - "Address"
      - "Adresse"
      - "Street"
      - "Strasse"

  policyholder_postal_code:
    normalize: trim
    hints:
      - "Post code"
      - "PLZ"
      - "Postal code"
      - "ZIP"

  policyholder_city:
    normalize: trim
    hints:
      - "Town"
      - "Ort"
      - "City"
      - "Stadt"

  policyholder_phone:
    normalize: phone_normalize
    hints:
      - "Telephone"
      - "Tel"
      - "Phone"
      - "Telefon"

  client_reference:
    normalize: trim
    hints:
      - "Client Ref"
      - "Kundenreferenz"
      - "Reference"
      - "Referenz"

  is_transferable:
    normalize: transferable_boolean
    hints:
      - "Assignability"
      - "Übertragbarkeit"
      - "Transferable"
      - "übertragbar"

  # Vehicle
  vehicle_make:
    normalize: trim
    validate: non_empty
    hints:
      - "Make"
      - "Marke"
      - "Brand"
      - "Manufacturer"

  vehicle_model:
    normalize: trim
    validate: non_empty
    hints:
      - "Model"
      - "Modell"
      - "Type"

  vehicle_vin:
    normalize: uppercase_trim
    validate: vin_format
    hints:
      - "Chassis"
      - "Fahrgestellnummer"
      - "VIN"
      - "Vehicle Identification"

  vehicle_fuel_type:
    normalize: trim
    hints:
      - "Fuel type"
      - "Kraftstofftyp"
      - "Treibstoff"

  vehicle_license_plate:
    normalize: uppercase_trim
    hints:
      - "Licence number"
      - "Kennzeichen"
      - "License plate"
      - "Kontrollschild"

  vehicle_first_registration:
    normalize: swiss_date_to_iso
    hints:
      - "Initial registration"
      - "Erstzulassung"
      - "First registration"
      - "Inverkehrsetzung"

  vehicle_current_km:
    normalize: extract_number
    hints:
      - "Current kilometre"
      - "Heutiger km-Stand"
      - "km-Stand"
      - "Mileage"
      - "Kilometerstand"

  vehicle_displacement_cc:
    normalize: extract_number
    hints:
      - "Engine displacement"
      - "Hubraum"
      - "Displacement"
      - "ccm"

  vehicle_weight_category_kg:
    normalize: extract_number
    hints:
      - "Weight category"
      - "Gewichtskategorie"
      - "Weight"
      - "Gewicht"

  vehicle_replacement_value:
    normalize: swiss_currency
    hints:
      - "Replacement value"
      - "Neuwertkategorie"
      - "New value"
      - "Neuwert"

  # Assistance
  assistance_repatriation_scope:
    normalize: trim
    hints:
      - "Repatriation"
      - "Repatriierung"
      - "Return transport"

  assistance_rental_per_day:
    normalize: swiss_currency
    hints:
      - "Replacement vehicle/day"
      - "Ersatzfahrzeug pro Tag"
      - "Rental per day"

  assistance_rental_max_event:
    normalize: swiss_currency
    hints:
      - "Maximum per event"
      - "Maximal pro Ereignis"
      - "Max per claim"

  assistance_towing_amount:
    normalize: swiss_currency
    hints:
      - "Towing"
      - "Abschleppen"
      - "Breakdown recovery"

  # Components (special handling in extractor - no hints needed)
  covered_components:
    normalize: none
    hints: []

  excluded_components:
    normalize: none
    hints: []

  coverage_scale:
    normalize: none
    hints: []

quality_gate:
  pass_if:
    - required_present_ratio >= 1.0
    - evidence_rate >= 0.7
  warn_if:
    - evidence_rate < 0.7
  fail_if:
    - required_present_ratio < 0.8
