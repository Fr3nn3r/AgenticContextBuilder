doc_type: invoice
version: v0

required_fields:
  - total_amount
  - currency
optional_fields:
  - vendor_name
  - purchase_date

field_rules:
  total_amount:
    normalize: money_to_decimal
    validate: is_money
    hints: ["total", "amount", "balance", "grand total", "total due"]

  currency:
    normalize: currency_normalize
    validate: is_currency
    hints: ["cad", "usd", "$", "eur", "gbp"]

  purchase_date:
    normalize: date_to_iso
    validate: is_date
    hints: ["date", "fecha", "purchase", "issued"]

  vendor_name:
    normalize: uppercase_trim
    validate: non_empty
    hints: ["hotel", "restaurant", "taxi", "vendor", "merchant", "name"]

quality_gate:
  pass_if:
    - required_present_ratio >= 1.0
    - evidence_rate >= 0.6
  warn_if:
    - evidence_rate < 0.6
  fail_if:
    - required_present_ratio < 1.0
